<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Artvision Portal</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg-primary: #1a1a2e;
      --bg-secondary: #16213e;
      --bg-card: rgba(255,255,255,0.05);
      --border: rgba(255,255,255,0.08);
      --text-primary: #ffffff;
      --text-secondary: rgba(255,255,255,0.5);
      --accent: #3b82f6;
      --accent-light: #60a5fa;
      --success: #4ade80;
      --warning: #fbbf24;
      --danger: #f87171;
    }
    
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      background: linear-gradient(180deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, #0f0f23 100%);
      min-height: 100vh;
      color: var(--text-primary);
      padding-bottom: 160px;
    }
    
    /* === HEADER === */
    .header {
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: sticky;
      top: 0;
      background: rgba(26, 26, 46, 0.95);
      backdrop-filter: blur(20px);
      z-index: 100;
      border-bottom: 1px solid var(--border);
    }
    
    .header-left { display: flex; align-items: center; gap: 14px; }
    
    .avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 600;
    }
    
    .client-name { font-size: 18px; font-weight: 600; }
    .client-domain { font-size: 14px; color: var(--text-secondary); margin-top: 2px; }
    
    .refresh-btn {
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      opacity: 0.6;
      background: none;
      border: none;
      color: #fff;
      cursor: pointer;
      border-radius: 12px;
      transition: all 0.2s;
    }
    .refresh-btn:active { background: var(--bg-card); transform: scale(0.95); }
    .refresh-btn.loading { animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* === CONTENT === */
    .content { padding: 0 16px; }
    .page { display: none; }
    .page.active { display: block; animation: fadeIn 0.3s ease; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* === STATS === */
    .stats-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 16px 0; }
    
    .stat-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 18px 20px;
    }
    
    .stat-label { font-size: 15px; color: var(--text-secondary); margin-bottom: 8px; }
    .stat-value { font-size: 36px; font-weight: 700; letter-spacing: -1px; }
    
    .stat-change {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-top: 6px;
      font-size: 16px;
      font-weight: 600;
    }
    .stat-change.up { color: var(--success); }
    .stat-change.down { color: var(--danger); }
    .stat-change svg { width: 14px; height: 14px; }

    /* === POSITION CARD === */
    .position-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 12px;
    }
    
    .position-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
    .position-label { font-size: 15px; color: var(--text-secondary); }
    .position-value { font-size: 42px; font-weight: 700; letter-spacing: -1px; }
    
    .chart-container { height: 120px; margin-top: 16px; }
    .chart-labels { display: flex; justify-content: space-between; margin-top: 10px; font-size: 13px; color: var(--text-secondary); }

    /* === QUERIES === */
    .queries-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 12px;
    }
    
    .queries-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .queries-title { font-size: 18px; font-weight: 600; }
    .queries-all { font-size: 15px; color: var(--accent-light); text-decoration: none; }
    
    .query-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 0;
      border-bottom: 1px solid var(--border);
    }
    .query-item:last-child { border-bottom: none; padding-bottom: 0; }
    
    .query-position {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      background: rgba(96, 165, 250, 0.15);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      font-weight: 700;
      color: var(--accent-light);
      flex-shrink: 0;
    }
    .query-position.top3 { background: rgba(251, 191, 36, 0.2); color: #fbbf24; }
    .query-position.top10 { background: rgba(74, 222, 128, 0.15); color: var(--success); }
    .query-position.top20 { background: rgba(96, 165, 250, 0.15); color: var(--accent-light); }
    .query-position.below { background: rgba(248, 113, 113, 0.15); color: var(--danger); }
    
    .query-info { flex: 1; min-width: 0; }
    .query-text { font-size: 16px; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .query-stats { font-size: 14px; color: var(--text-secondary); margin-top: 3px; }
    
    .query-change { font-size: 15px; font-weight: 600; display: flex; align-items: center; gap: 2px; }
    .query-change.up { color: var(--success); }
    .query-change.down { color: var(--danger); }
    .query-change.neutral { color: var(--text-secondary); }

    /* === REPORTS === */
    .report-item {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px 20px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 14px;
    }
    
    .report-icon { font-size: 32px; }
    .report-info { flex: 1; }
    .report-title { font-size: 16px; font-weight: 600; }
    .report-date { font-size: 13px; color: var(--text-secondary); margin-top: 2px; }
    .report-btn {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 8px 16px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }

    /* === DOCUMENTS === */
    .doc-item {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px 20px;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 14px;
    }
    .doc-icon { font-size: 28px; }
    .doc-info { flex: 1; }
    .doc-title { font-size: 15px; font-weight: 600; }
    .doc-meta { font-size: 13px; color: var(--text-secondary); margin-top: 2px; }
    .doc-status { padding: 4px 10px; border-radius: 8px; font-size: 12px; font-weight: 600; }
    .doc-status.paid { background: rgba(74,222,128,0.15); color: var(--success); }
    .doc-status.pending { background: rgba(251,191,36,0.15); color: var(--warning); }

    /* === TIPS === */
    .tip-card {
      background: linear-gradient(135deg, rgba(59,130,246,0.15) 0%, rgba(139,92,246,0.15) 100%);
      border: 1px solid rgba(59,130,246,0.3);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 12px;
    }
    .tip-card.high { 
      background: linear-gradient(135deg, rgba(251,191,36,0.15) 0%, rgba(249,115,22,0.15) 100%);
      border-color: rgba(251,191,36,0.3);
    }
    
    .tip-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
    .tip-icon { font-size: 24px; }
    .tip-title { font-size: 16px; font-weight: 600; }
    .tip-text { font-size: 14px; color: var(--text-secondary); line-height: 1.5; }
    .tip-action {
      margin-top: 12px;
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
    }

    /* === TAB BAR === */
    .tab-bar {
      position: fixed;
      bottom: 70px;
      left: 0;
      right: 0;
      background: rgba(15, 15, 35, 0.98);
      backdrop-filter: blur(20px);
      border-top: 1px solid var(--border);
      display: flex;
      justify-content: space-around;
      padding: 10px 0 12px;
      z-index: 100;
    }
    
    .tab-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      color: var(--text-secondary);
      font-size: 11px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px 12px;
      border-radius: 8px;
      transition: all 0.2s;
    }
    .tab-item.active { color: var(--accent-light); }
    .tab-item svg { width: 24px; height: 24px; }

    /* === CTA BUTTON === */
    .cta-wrap {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 12px 16px 24px;
      background: linear-gradient(180deg, transparent 0%, rgba(15, 15, 35, 0.98) 30%);
      z-index: 100;
    }
    
    .cta-btn {
      width: 100%;
      height: 54px;
      border-radius: 14px;
      background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
      border: none;
      color: #fff;
      font-size: 17px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      cursor: pointer;
      box-shadow: 0 4px 20px rgba(59, 130, 246, 0.4);
      transition: transform 0.2s;
    }
    .cta-btn:active { transform: scale(0.98); }

    /* === SECTION TITLE === */
    .section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin: 20px 0 12px;
    }

    /* === LOADING === */
    .loading-spinner {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px;
      color: var(--text-secondary);
    }
    .loading-spinner::before {
      content: '';
      width: 32px;
      height: 32px;
      border: 3px solid var(--border);
      border-top-color: var(--accent);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 12px;
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="header-left">
      <div class="avatar" id="avatar">–¢</div>
      <div>
        <div class="client-name" id="clientName">–¢–≤–æ—Ä–∏–º –°–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ</div>
        <div class="client-domain" id="clientDomain">tvorimsovershenstvo.ru</div>
      </div>
    </div>
    <button class="refresh-btn" id="refreshBtn" onclick="refresh()">‚Üª</button>
  </header>

  <div class="content">
    
    <!-- PAGE: –û–±–∑–æ—Ä -->
    <div class="page active" id="page-overview">
      <div class="stats-row">
        <div class="stat-card">
          <div class="stat-label">–ü–æ–∫–∞–∑—ã</div>
          <div class="stat-value" id="statShows">71</div>
          <div class="stat-change up" id="changeShows">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M18 15l-6-6-6 6"/></svg>
            <span>23%</span>
          </div>
        </div>
        <div class="stat-card">
          <div class="stat-label">–ö–ª–∏–∫–∏</div>
          <div class="stat-value" id="statClicks">6</div>
          <div class="stat-change up" id="changeClicks">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M18 15l-6-6-6 6"/></svg>
            <span>15%</span>
          </div>
        </div>
      </div>

      <div class="position-card">
        <div class="position-header">
          <div>
            <div class="position-label">–°—Ä–µ–¥–Ω—è—è –ø–æ–∑–∏—Ü–∏—è</div>
            <div class="position-value" id="statPosition">8.1</div>
          </div>
          <div class="stat-change up" id="changePosition">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" style="width:14px;height:14px"><path d="M18 15l-6-6-6 6"/></svg>
            <span>8%</span>
          </div>
        </div>
        <div class="chart-container">
          <canvas id="positionsChart"></canvas>
        </div>
        <div class="chart-labels">
          <span>–ù–µ–¥–µ–ª—è –Ω–∞–∑–∞–¥</span>
          <span>–°–µ–≥–æ–¥–Ω—è</span>
        </div>
      </div>

      <div class="queries-card">
        <div class="queries-header">
          <div class="queries-title">–¢–æ–ø –∑–∞–ø—Ä–æ—Å—ã</div>
          <a href="#" class="queries-all" onclick="setTab('positions'); return false;">–í—Å–µ ‚Üí</a>
        </div>
        <div id="topQueries"></div>
      </div>
    </div>

    <!-- PAGE: –ü–æ–∑–∏—Ü–∏–∏ -->
    <div class="page" id="page-positions">
      <div class="section-title">–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã</div>
      <div id="allQueries"></div>
    </div>

    <!-- PAGE: –û—Ç—á—ë—Ç—ã -->
    <div class="page" id="page-reports">
      <div class="section-title">SEO –û—Ç—á—ë—Ç—ã</div>
      <div id="reportsList"></div>
      
      <div class="section-title">–î–æ–∫—É–º–µ–Ω—Ç—ã</div>
      <div id="docsList"></div>
    </div>

    <!-- PAGE: –°–æ–≤–µ—Ç—ã -->
    <div class="page" id="page-tips">
      <div class="section-title">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–æ—Å—Ç—É</div>
      <div id="tipsList"></div>
    </div>

  </div>

  <!-- TAB BAR -->
  <nav class="tab-bar">
    <button class="tab-item active" onclick="setTab('overview')" data-tab="overview">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 3v18h18"/><path d="M18 9l-5 5-4-4-3 3"/></svg>
      <span>–û–±–∑–æ—Ä</span>
    </button>
    <button class="tab-item" onclick="setTab('positions')" data-tab="positions">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 17l6-6 4 4 8-8"/><path d="M17 7h4v4"/></svg>
      <span>–ü–æ–∑–∏—Ü–∏–∏</span>
    </button>
    <button class="tab-item" onclick="setTab('reports')" data-tab="reports">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M9 9h6M9 13h6M9 17h4"/></svg>
      <span>–û—Ç—á—ë—Ç—ã</span>
    </button>
    <button class="tab-item" onclick="setTab('tips')" data-tab="tips">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21h6M12 3a6 6 0 0 0-3 11.2V17h6v-2.8A6 6 0 0 0 12 3z"/></svg>
      <span>–°–æ–≤–µ—Ç—ã</span>
    </button>
  </nav>

  <!-- CTA BUTTON -->
  <div class="cta-wrap">
    <button class="cta-btn" onclick="openChat()">
      üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä—É
    </button>
  </div>

  <script>
    // === DATA ===
    const DATA = {
      client: {
        name: "–¢–≤–æ—Ä–∏–º –°–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ",
        domain: "tvorimsovershenstvo.ru",
        avatar: "–¢"
      },
      stats: {
        shows: { value: 71, change: 23 },
        clicks: { value: 6, change: 15 },
        position: { value: 8.1, change: 8 }
      },
      positions: [14, 13, 12, 11, 10, 9, 8],
      queries: [
        { q: "—Ç–≤–æ—Ä–∏–º —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ —Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è", pos: 1.3, shows: 9, clicks: 3, change: 2 },
        { q: "—Ç–≤–æ—Ä–∏–º —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–æ", pos: 1.9, shows: 8, clicks: 1, change: 1 },
        { q: "–∫–µ—Ä–∞–º–∏—á–µ—Å–∫–∏–µ –≤–∏–Ω–∏—Ä—ã e max", pos: 6.0, shows: 7, clicks: 0, change: -1 },
        { q: "–µ–≤—Å–µ–µ–Ω–∫–æ–≤–∞ –∏—Ä–∏–Ω–∞ –≤—è—á–µ—Å–ª–∞–≤–æ–≤–Ω–∞", pos: 8.6, shows: 5, clicks: 1, change: 3 },
        { q: "—Å—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è –ø–µ—Ç—Ä–æ–≥—Ä–∞–¥—Å–∫–∞—è", pos: 12.4, shows: 4, clicks: 0, change: 0 },
        { q: "–≤–∏–Ω–∏—Ä—ã —Å–ø–± —Ü–µ–Ω–∞", pos: 15.2, shows: 6, clicks: 0, change: -2 },
        { q: "–∏–º–ø–ª–∞–Ω—Ç–∞—Ü–∏—è –∑—É–±–æ–≤ –ø–µ—Ç—Ä–æ–≥—Ä–∞–¥—Å–∫–∞—è", pos: 18.5, shows: 5, clicks: 0, change: 1 },
        { q: "–æ—Ç–±–µ–ª–∏–≤–∞–Ω–∏–µ –∑—É–±–æ–≤ —Å–ø–±", pos: 22.3, shows: 4, clicks: 0, change: -3 },
        { q: "–ª–µ—á–µ–Ω–∏–µ –∫–∞—Ä–∏–µ—Å–∞ —Å–ø–±", pos: 25.1, shows: 3, clicks: 0, change: 0 },
        { q: "–ø—Ä–æ—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –∑—É–±–æ–≤ —Å–ø–±", pos: 28.7, shows: 2, clicks: 0, change: 2 }
      ],
      reports: [
        { title: "SEO –æ—Ç—á—ë—Ç ‚Äî –î–µ–∫–∞–±—Ä—å 2024", date: "25.12.2024", type: "seo", url: "#" },
        { title: "–ö–æ–Ω—Ç–µ–Ω—Ç-–ø–ª–∞–Ω Q1 2025", date: "20.12.2024", type: "plan", url: "#" },
        { title: "–ê—É–¥–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π", date: "15.12.2024", type: "audit", url: "#" }
      ],
      docs: [
        { title: "–°—á—ë—Ç #2024-089", amount: "45 000 ‚ÇΩ", date: "20.12.2024", status: "pending" },
        { title: "–ê–∫—Ç #2024-088", amount: "45 000 ‚ÇΩ", date: "01.12.2024", status: "paid" },
        { title: "–°—á—ë—Ç #2024-087", amount: "45 000 ‚ÇΩ", date: "20.11.2024", status: "paid" }
      ],
      tips: [
        { 
          title: "–î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —É—Å–ª—É–≥–∏", 
          text: "–°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É ¬´–õ–µ—á–µ–Ω–∏–µ –ø—É–ª—å–ø–∏—Ç–∞¬ª ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª 120 –ø–æ–∫–∞–∑–æ–≤/–º–µ—Å –ø–æ –¥–∞–Ω–Ω—ã–º Wordstat", 
          priority: "high",
          action: "–°–æ–∑–¥–∞—Ç—å –¢–ó"
        },
        { 
          title: "–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å Title", 
          text: "–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ /implantation Title —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π (78 —Å–∏–º–≤–æ–ª–æ–≤). –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –¥–æ 60 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –≤—ã–¥–∞—á–µ.", 
          priority: "medium",
          action: "–ü–æ–¥—Ä–æ–±–Ω–µ–µ"
        },
        { 
          title: "–î–æ–±–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤—ã", 
          text: "–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞—Ö —É—Å–ª—É–≥ –Ω–µ—Ç –æ—Ç–∑—ã–≤–æ–≤. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ 3-5 –æ—Ç–∑—ã–≤–æ–≤ —É–≤–µ–ª–∏—á–∏—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é –Ω–∞ 15-20%", 
          priority: "medium",
          action: "–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è"
        }
      ]
    };

    // === STATE ===
    let currentTab = 'overview';
    let chart = null;

    // === TELEGRAM ===
    const tg = window.Telegram?.WebApp;
    if (tg) {
      tg.ready();
      tg.expand();
    }

    // === RENDER ===
    function renderQueryItem(q) {
      let posClass = 'below';
      if (q.pos <= 3) posClass = 'top3';
      else if (q.pos <= 10) posClass = 'top10';
      else if (q.pos <= 20) posClass = 'top20';
      
      let changeClass = 'neutral';
      let changeIcon = '‚Äî';
      if (q.change > 0) {
        changeClass = 'up';
        changeIcon = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" style="width:12px;height:12px"><path d="M18 15l-6-6-6 6"/></svg>`;
      } else if (q.change < 0) {
        changeClass = 'down';
        changeIcon = `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" style="width:12px;height:12px"><path d="M6 9l6 6 6-6"/></svg>`;
      }
      
      return `
        <div class="query-item">
          <div class="query-position ${posClass}">${Math.round(q.pos)}</div>
          <div class="query-info">
            <div class="query-text">${q.q}</div>
            <div class="query-stats">${q.shows} –ø–æ–∫–∞–∑–æ–≤ ¬∑ ${q.clicks} –∫–ª–∏–∫–æ–≤</div>
          </div>
          <div class="query-change ${changeClass}">
            ${changeIcon}
            ${q.change !== 0 ? Math.abs(q.change) : ''}
          </div>
        </div>
      `;
    }

    function renderOverview() {
      // Stats
      document.getElementById('statShows').textContent = DATA.stats.shows.value.toLocaleString();
      document.getElementById('statClicks').textContent = DATA.stats.clicks.value.toLocaleString();
      document.getElementById('statPosition').textContent = DATA.stats.position.value;
      
      document.querySelector('#changeShows span').textContent = DATA.stats.shows.change + '%';
      document.querySelector('#changeClicks span').textContent = DATA.stats.clicks.change + '%';
      document.querySelector('#changePosition span').textContent = DATA.stats.position.change + '%';
      
      // Top Queries
      document.getElementById('topQueries').innerHTML = DATA.queries.slice(0, 3).map(q => renderQueryItem(q)).join('');
      
      // Chart
      renderPositionsChart();
    }

    function renderPositionsChart() {
      const ctx = document.getElementById('positionsChart').getContext('2d');
      
      if (chart) chart.destroy();
      
      chart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['', '', '', '', '', '', ''],
          datasets: [{
            data: DATA.positions,
            backgroundColor: DATA.positions.map(p => 
              p <= 10 ? '#4ade80' : p <= 20 ? '#60a5fa' : '#f87171'
            ),
            borderRadius: 6,
            barThickness: 28
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          indexAxis: 'x',
          scales: {
            y: {
              reverse: true,
              min: 1,
              max: 25,
              grid: { color: 'rgba(255,255,255,0.05)' },
              ticks: { display: false }
            },
            x: { grid: { display: false }, ticks: { display: false } }
          },
          plugins: { legend: { display: false }, tooltip: { enabled: false } }
        }
      });
    }

    function renderPositions() {
      document.getElementById('allQueries').innerHTML = DATA.queries.map(q => renderQueryItem(q)).join('');
    }

    function renderReports() {
      const icons = { seo: 'üìä', plan: 'üìã', audit: 'üîç' };
      
      document.getElementById('reportsList').innerHTML = DATA.reports.map(r => `
        <div class="report-item">
          <div class="report-icon">${icons[r.type] || 'üìÑ'}</div>
          <div class="report-info">
            <div class="report-title">${r.title}</div>
            <div class="report-date">${r.date}</div>
          </div>
          <button class="report-btn" onclick="openReport('${r.url}')">–û—Ç–∫—Ä—ã—Ç—å</button>
        </div>
      `).join('');
      
      document.getElementById('docsList').innerHTML = DATA.docs.map(doc => `
        <div class="doc-item">
          <div class="doc-icon">${doc.status === 'paid' ? '‚úÖ' : 'üìÑ'}</div>
          <div class="doc-info">
            <div class="doc-title">${doc.title}</div>
            <div class="doc-meta">${doc.amount} ¬∑ ${doc.date}</div>
          </div>
          <div class="doc-status ${doc.status}">${doc.status === 'paid' ? '–û–ø–ª–∞—á–µ–Ω' : '–û–∂–∏–¥–∞–µ—Ç'}</div>
        </div>
      `).join('');
    }

    function renderTips() {
      document.getElementById('tipsList').innerHTML = DATA.tips.map(tip => `
        <div class="tip-card ${tip.priority === 'high' ? 'high' : ''}">
          <div class="tip-header">
            <div class="tip-icon">${tip.priority === 'high' ? 'üî•' : 'üí°'}</div>
            <div class="tip-title">${tip.title}</div>
          </div>
          <div class="tip-text">${tip.text}</div>
          <button class="tip-action" onclick="handleTip('${tip.title}')">${tip.action}</button>
        </div>
      `).join('');
    }

    // === NAVIGATION ===
    function setTab(tabId) {
      currentTab = tabId;
      
      // Hide all pages
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      document.getElementById('page-' + tabId).classList.add('active');
      
      // Update tabs
      document.querySelectorAll('.tab-item').forEach(t => {
        t.classList.toggle('active', t.dataset.tab === tabId);
      });
      
      // Render content
      if (tabId === 'positions') renderPositions();
      if (tabId === 'reports') renderReports();
      if (tabId === 'tips') renderTips();
    }

    // === ACTIONS ===
    function refresh() {
      const btn = document.getElementById('refreshBtn');
      btn.classList.add('loading');
      
      // Simulate API call
      setTimeout(() => {
        btn.classList.remove('loading');
        renderOverview();
      }, 1000);
    }

    function openChat() {
      if (tg) {
        tg.openTelegramLink('https://t.me/artvision_support');
      } else {
        window.open('https://t.me/artvision_support', '_blank');
      }
    }

    function openReport(url) {
      if (tg) {
        tg.showAlert('–û—Ç—á—ë—Ç –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ –Ω–æ–≤–æ–º –æ–∫–Ω–µ');
      }
      // window.open(url, '_blank');
    }

    function handleTip(title) {
      if (tg) {
        tg.showAlert('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: ' + title + '\n\n–°–≤—è–∂–∏—Ç–µ—Å—å —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏');
      } else {
        alert('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: ' + title);
      }
    }

    // === INIT ===
    renderOverview();
  </script>
</body>
</html>
